# 用户故事 2-2：实时预览功能

## 故事描述

作为一名内容创作者，我希望在编辑Markdown时能够看到实时渲染效果，以便了解格式是否正确。

## 验收标准

- [ ] 编辑内容时，预览能够实时更新
- [ ] 预览更新响应迅速（< 100ms）
- [ ] 支持编辑模式和预览模式切换
- [ ] 支持同时显示编辑和预览（分屏模式）
- [ ] 预览内容与编辑内容完全对应

## 业务价值

- 提供专业的实时预览功能
- 帮助用户确认格式效果
- 提升编辑效率和体验

## 详细实现步骤

### 前端实现步骤

1. **配置markdown-it解析器**
   - 初始化markdown-it实例
   - 配置markdown-it插件（如highlightjs、toc等）
   - 设置markdown-it的渲染选项

2. **实现实时预览功能**
   - 使用useState管理编辑器内容
   - 使用useEffect监听内容变化
   - 使用markdown-it实时解析Markdown内容
   - 将解析结果渲染到预览区域

3. **实现视图模式切换**
   - 支持 `edit` 模式（纯编辑）
   - 支持 `preview` 模式（纯预览）
   - 支持 `live` 模式（编辑+预览）
   - 添加模式切换按钮

4. **优化预览体验**
   - 配置预览样式
   - 设置预览区域的滚动同步
   - 优化预览渲染性能
   - 添加防抖处理避免频繁渲染

5. **界面交互优化**
   - 添加工具栏按钮控制预览模式
   - 实现键盘快捷键支持
   - 添加全屏预览功能

### 后端实现步骤

无需后端实现，纯前端功能。

### 基本测试步骤

1. **实时预览测试**
   - 测试编辑时预览实时更新
   - 测试预览渲染准确性
   - 测试性能表现

2. **模式切换测试**
   - 测试编辑模式切换
   - 测试预览模式切换
   - 测试分屏模式功能

---

## 相关文件

- 前端文件：
  - `components/editor/MarkdownEditor.tsx`
- 依赖包：
  - `markdown-it`（核心解析器）
  - `markdown-it-highlightjs`（代码高亮）

## 注意事项

- 利用markdown-it的高性能解析能力
- 确保预览模式的响应速度
- 考虑添加预览样式自定义
- 注意编辑器在不同视图模式下的用户体验
- 确保预览内容的安全性
- 注意markdown-it的插件配置和性能优化
