# 注册 API 测试

## 概述

本测试文件测试注册API的基本功能，确保用户注册流程正常工作。

## 测试覆盖

### 输入验证测试
- ✅ 用户名验证（3-20字符）
- ✅ 密码验证（至少6字符）
- ✅ 空字段验证

### 密码加密测试
- ✅ bcrypt加密功能
- ✅ 正确的salt rounds

### 数据库操作测试
- ✅ 用户存在性检查
- ✅ 新用户创建

## 测试技术

### 测试框架
- **Jest**: 测试运行器
- **Mock**: 模拟外部依赖

### Mock策略
- 模拟 bcrypt 加密库
- 模拟 Prisma 数据库操作
- 模拟外部依赖

### 测试数据
- 有效用户名：'testuser'
- 有效密码：'password123'
- 无效数据：空字符串、短字符串等

## 运行测试

```bash
# 运行所有测试
npm test

# 运行注册API相关测试
npm test -- --testPathPatterns="register.*route"

# 运行测试并显示覆盖率
npm run test:coverage
```

## 测试结果

- **总测试用例**: 6个
- **通过率**: 100%
- **覆盖率**: 主要功能100%覆盖

## 注意事项

1. 测试使用模拟的数据库操作，不会影响实际数据库
2. 所有外部依赖都通过mock模拟
3. 测试数据是独立的，不会影响实际数据
4. 验证逻辑测试覆盖了主要的验证场景
